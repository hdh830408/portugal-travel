<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a0a00">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <title>포르투갈 여행</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div id="app">
  <!-- HEADER -->
  <div class="header">
    <div>
      <h1 id="appTitle">🇵🇹 Portugal 2026</h1>
      <div class="dates" id="appDates">May 1–10 · 9박10일 여행 가이드 (v9)</div>
    </div>
    <div class="header-right">
      <button class="ai-badge" id="btnToggleAI">✨ AI Agent</button>
      <button class="settings-btn" id="settingsBtn">⚙️</button>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <div class="tab active" data-tab="food">
      <span class="tab-icon">🍽️</span>맛집
    </div>
    <div class="tab" data-tab="landmark">
      <span class="tab-icon">🏛️</span>관광지
    </div>
    <div class="tab" data-tab="schedule">
      <span class="tab-icon">📅</span>일정
    </div>
    <div class="tab" data-tab="route">
      <span class="tab-icon">🗺️</span>동선
    </div>
    <div class="tab" data-tab="saved">
      <span class="tab-icon">⭐</span>저장됨
    </div>
  </div>

  <!-- CONTENT -->
  <div class="content">
    <!-- FOOD PAGE -->
    <div id="page-food" class="page active">
      <div class="search-bar">
        <input class="search-input" placeholder="🔍 식당 이름, 주소 검색..." id="searchInput">
        <button class="place-btn btn-map" style="width:auto;padding:0 12px;margin-left:8px;height:42px;flex-shrink:0" id="btnFindLocationFood">📍 내 주변</button>
      </div>
      <div class="landmark-filter-bar" id="landmarkFilterBar">
        <span class="landmark-filter-text">📍 <span id="landmarkFilterName"></span> 근처 맛집</span>
        <button class="landmark-filter-close" id="btnClearLandmarkFilter">✕</button>
      </div>
      <div class="day-pills" id="dayPills"></div>
      <div class="cat-filter" id="catFilter"></div>
      <div id="placeList"></div>
    </div>

    <!-- LANDMARK PAGE -->
    <div id="page-landmark" class="page">
      <div class="search-bar">
        <input class="search-input" placeholder="🔍 관광지 이름, 주소 검색..." id="landmarkSearchInput">
        <button class="place-btn btn-map" style="width:auto;padding:0 12px;margin-left:8px;height:42px;flex-shrink:0" id="btnFindLocationLandmark">📍 내 주변</button>
      </div>
      <div class="day-pills" id="landmarkDayPills"></div>
      <div class="cat-filter" id="landmarkCatFilter"></div>
      <div id="landmarkList"></div>
    </div>

    <!-- SCHEDULE PAGE -->
    <div id="page-schedule" class="page">
      <div id="scheduleList"></div>
    </div>

    <!-- ROUTE PAGE -->
    <div id="page-route" class="page">
      <div class="route-day-selector">
        <button class="route-day-btn" data-day="DAY 2">DAY 2</button>
        <button class="route-day-btn" data-day="DAY 3">DAY 3</button>
        <button class="route-day-btn" data-day="DAY 4">DAY 4</button>
        <button class="route-day-btn" data-day="DAY 5">DAY 5</button>
        <button class="route-day-btn" data-day="DAY 6">DAY 6</button>
        <button class="route-day-btn active" data-day="DAY 7">DAY 7</button>
        <button class="route-day-btn" data-day="DAY 8">DAY 8</button>
        <button class="route-day-btn" data-day="DAY 9">DAY 9</button>
      </div>
      <div id="routeContent"></div>
    </div>

    <!-- SAVED PAGE -->
    <div id="page-saved" class="page">
      <div id="savedList"></div>
    </div>
  </div>
</div>

<!-- SETTINGS PANEL -->
<div class="settings-panel" id="settingsPanel">
  <div class="settings-card" style="max-height:85vh;overflow-y:auto">
    <div class="settings-title">⚙️ AI 설정</div>
    
    <div id="apiStatus"></div>

    <!-- Provider 탭 -->
    <div class="api-section-title">AI 제공자 선택</div>
    <div class="provider-tabs">
      <button class="provider-tab" id="tab-openrouter" data-provider="openrouter">
        🔀 OpenRouter<br><span style="font-size:9px;font-weight:400">크레딧필요</span>
      </button>
      <button class="provider-tab active" id="tab-google" data-provider="google">
        🆓 Google<br><span style="font-size:9px;font-weight:400">완전무료</span>
      </button>
      <button class="provider-tab" id="tab-anthropic" data-provider="anthropic">
        🤖 Claude<br><span style="font-size:9px;font-weight:400">유료</span>
      </button>
    </div>

    <!-- OpenRouter 섹션 -->
    <div id="section-openrouter" style="display:none">
      <div class="api-section-title">무료 모델 선택</div>
      <div class="model-list" id="modelList">
        <div class="model-option selected" data-model="google/gemini-2.0-flash-lite-preview-02-05:free">
          <span class="model-option-badge badge-free">🆓 무료</span>
          <div class="model-option-name">Gemini 2.0 Flash Lite ⭐ 추천</div>
          <div class="model-option-desc">Google 최신 모델 · 빠르고 똑똑함</div>
        </div>
        <div class="model-option" data-model="meta-llama/llama-3.3-70b-instruct:free">
          <span class="model-option-badge badge-free">🆓 무료</span>
          <div class="model-option-name">Llama 3.3 70B</div>
          <div class="model-option-desc">Meta 최신 고성능 모델</div>
        </div>
        <div class="model-option" data-model="qwen/qwen-2.5-72b-instruct:free">
          <span class="model-option-badge badge-free">🆓 무료</span>
          <div class="model-option-name">Qwen 2.5 72B</div>
          <div class="model-option-desc">알리바바 최신 · 한국어 잘함</div>
        </div>
        <div class="model-option" data-model="openrouter/free">
          <span class="model-option-badge badge-free" style="background:rgba(167,139,250,.15);color:#a78bfa">🔀 자동</span>
          <div class="model-option-name">Free Router (자동)</div>
          <div class="model-option-desc">가용한 무료 모델 자동 선택</div>
        </div>
      </div>

      <div class="api-section-title">OPENROUTER API KEY</div>
      <input class="settings-input" id="apiKeyInput" type="password"
        placeholder="sk-or-v1-..."
        autocomplete="off" autocorrect="off" autocapitalize="none">
      <a class="settings-link" href="https://openrouter.ai/keys" target="_blank">
        🔗 openrouter.ai/keys 에서 무료 발급 (신용카드 불필요)
      </a>
    </div>

    <!-- Google AI Studio 섹션 -->
    <div id="section-google">
      <div class="model-list">
        <div class="model-option selected" data-model="gemini-2.0-flash">
          <span class="model-option-badge badge-free">🆓 완전무료</span>
          <div class="model-option-name">Gemini 2.0 Flash ⭐ 추천</div>
          <div class="model-option-desc">Google 최신 · v1 API 완전 지원 · 가장 안정적</div>
        </div>
        <div class="model-option" data-model="gemini-2.0-flash-lite">
          <span class="model-option-badge badge-free">🆓 완전무료</span>
          <div class="model-option-name">Gemini 2.0 Flash Lite</div>
          <div class="model-option-desc">더 가볍고 빠름 · 쿼터 여유로움</div>
        </div>
      </div>
      <div class="api-section-title">GOOGLE AI STUDIO API KEY</div>
      <input class="settings-input" id="apiKeyInputGoogle" type="password"
        placeholder="AIzaSy..."
        autocomplete="off" autocorrect="off" autocapitalize="none">
      <a class="settings-link" href="https://aistudio.google.com/apikey" target="_blank">
        🔗 aistudio.google.com/apikey 에서 무료 발급 (카드 불필요)
      </a>
    </div>

    <!-- Anthropic 섹션 -->
    <div id="section-anthropic" style="display:none">
      <div class="model-list">
        <div class="model-option selected" data-model="claude-sonnet-4-20250514">
          <span class="model-option-badge badge-paid">💳 유료</span>
          <div class="model-option-name">Claude Sonnet 4</div>
          <div class="model-option-desc">가장 균형잡힌 성능 · 한국어 최고 품질</div>
        </div>
        <div class="model-option" data-model="claude-haiku-4-5-20251001">
          <span class="model-option-badge badge-paid">💳 유료 (저렴)</span>
          <div class="model-option-name">Claude Haiku 4.5</div>
          <div class="model-option-desc">빠르고 저렴 · 간단한 추천에 적합</div>
        </div>
      </div>
      <div class="api-section-title">ANTHROPIC API KEY</div>
      <input class="settings-input" id="apiKeyInputAnthropic" type="password"
        placeholder="sk-ant-api03-..."
        autocomplete="off" autocorrect="off" autocapitalize="none">
      <a class="settings-link" href="https://console.anthropic.com" target="_blank">
        🔗 console.anthropic.com 에서 발급
      </a>
    </div>

    <div class="settings-actions">
      <button class="btn-cancel" id="btnSettingsClose">닫기</button>
      <button class="btn-clear" id="btnResetApp">전체 초기화</button>
      <button class="btn-save" id="btnSaveApiKey">저장</button>
    </div>
  </div>
</div>

<!-- AI PANEL -->
<div class="ai-panel" id="aiPanel">
  <div class="ai-panel-header">
    <span class="ai-panel-title">✨ 포르투갈 여행 AI</span>
    <button class="ai-close" id="btnAIClose">×</button>
  </div>
  <div class="ai-suggestions">
    <div class="ai-sug" data-sug="오늘 저녁 해산물 추천해줘">🦐 해산물 추천</div>
    <div class="ai-sug" data-sug="가성비 좋은 맛집 알려줘">💰 가성비 맛집</div>
    <div class="ai-sug" data-sug="리스본 브런치 어디가 좋아?">☕ 브런치 추천</div>
  </div>
  <div class="ai-messages" id="aiMessages">
    <div class="msg msg-ai">안녕하세요! 포르투갈 여행 도우미예요 🇵🇹<br>맛집, 일정, 꿀팁 뭐든 물어보세요!</div>
  </div>
  <div class="ai-input-row">
    <input class="ai-input" id="aiInput" placeholder="여행에 대해 뭐든 물어보세요...">
    <button class="ai-send" id="aiSend">전송</button>
  </div>
</div>

<!-- MODAL -->
<div class="modal" id="placeModal">
  <div class="modal-card" id="modalCard">
    <button class="modal-close" id="btnModalClose">×</button>
    <div id="modalContent"></div>
  </div>
</div>

<!-- GUIDE MODAL (장소 해설 팝업) -->
<div class="guide-modal" id="guideModal">
  <div class="guide-card">
    <div class="guide-header">
      <div class="guide-header-top">
        <span class="guide-emoji" id="guideEmoji">📍</span>
        <div class="guide-title" id="guideTitle">장소명</div>
        <button class="guide-close" id="btnGuideClose">✕</button>
      </div>
      <div class="guide-subtitle" id="guideSubtitle">장소 설명</div>
    </div>
    <div class="guide-content" id="guideContent">
      <!-- 동적으로 채워짐 -->
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- LANDMARK TAG POPUP -->
<div class="tag-popup-overlay" id="tagPopupOverlay">
  <div class="tag-popup">
    <div class="tag-popup-title">📍 <span id="tagPopupName"></span></div>
    <button class="tag-popup-btn" id="btnFilterByLandmark">
      <span class="tag-popup-btn-icon">🔍</span> 근처 맛집 보기
    </button>
    <button class="tag-popup-btn" id="btnOpenLandmarkMap">
      <span class="tag-popup-btn-icon">🗺️</span> 지도에서 보기
    </button>
    <button class="tag-popup-btn" id="btnOpenLandmarkGuide">
      <span class="tag-popup-btn-icon">ℹ️</span> 장소 정보
    </button>
  </div>
</div>

    <script src="coords_data.js"></script>
    <script src="portugal_guides.js"></script>
    <script src="portugal_data.js"></script>
    <script src="js/state.js"></script>
    <script src="js/store.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data-service.js"></script>
    <script src="js/toast.js"></script>
    <script src="js/skeleton.js"></script>
    <script src="js/place-card.js"></script>
    <script src="js/modal.js"></script>
    <script src="js/ui-components.js"></script>
    <script src="js/ai-service.js"></script>
    <script src="js/ai-controller.js"></script>
    <script src="js/app.js"></script>
</body>
</html>